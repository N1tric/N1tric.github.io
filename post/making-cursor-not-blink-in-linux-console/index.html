<!DOCTYPE html>
<html lang="zh-cn">
  <head>
      <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/custom.css">

    <title>Making Cursor Not Blink in Linux Console | Nutr1t07's Blog</title>
  </head>

  <body>
    <div class="container">
            <div class="sidebar">
            <nav>
                <h3 id="logo">Nutr1t07</h3>
                <ul>
                                      <li><a href="/">Index</a></li>
                                      <li><a href="/page/friends/">Friends</a></li>
                  
                </ul>
            </nav>
            &nbsp;
      </div>

      <div class="content">
        <h3>Making Cursor Not Blink in Linux Console</h3>
        <p>I am not a fan of blinking cursors. The cursor, blinking endlessly, always reminds me of the shitty codes I'm writing, the ugly interface I'm facing, as well as my pitiful time wasted when I'm thinking. Anyway, I decided to turn it off.</p>
<p>Comparing to terminal emulator, the cursor appearance in the Linux console (which is, not to enter the desktop environment) is rather difficult to configure. There is no direct configuration file that can be modified to change its behavior. I found a <a href="http://www.friendlyarm.net/forum/topic/2998" >post</a> which said that there are some kernel parameters, such as <code>vt.global_cursor_default</code>, <code>vt.cur_default</code>, that can affect the cursor on boot, and thus the Linux console. Their descriptions as follows:</p>
<pre><code>vt.cur_default= [VT] Default cursor shape.
                Format: 0xCCBBAA, where AA, BB, and CC are the same as
                the parameters of the &lt;Esc&gt;[?A;B;Cc escape sequence;
                see VGA-softcursor.txt. Default: 2 = underline.

vt.global_cursor_default=
                [VT]
                Format=&lt;-1|0|1&gt;
                Set system-wide default for whether a cursor
                is shown on new VTs. Default is -1,
                i.e. cursors will be created by default unless
                overridden by individual drivers. 0 will hide
                cursors, 1 will display them.</code></pre>
<p>Settings to <code>vt.global_cursor_default</code> only determine whether cursors show or hide, while <code>vt.cur_default</code> , for the default cursor shape, seems to have more flexible options. But when I tried to read <a href="https://www.kernel.org/doc/html/latest/admin-guide/vga-softcursor.html" ><code>VGA-softcursor.txt</code></a> I got sort of confused. Some many terminologies and usages were beyond my knowledge. But I'll still try my best to describe it.</p>
<h4>The Escape Sequence</h4>
<p>The cursor appearance is controlled, by the sequence <code>&lt;ESC&gt;[?1;2;3c</code>. The first argument changes the cursor size, and the rest is for cursor color.</p>
<p>You can try them in Linux console by entering <code>echo -e &#39;\033[?1;2;3c&#39;</code>. For example,</p>
<blockquote>
<p>To get normal blinking underline(<code>2</code> for the first argument), use:</p>
<pre><code>echo -e &#39;\033[?2c&#39;</code></pre>
<p>To get blinking block(<code>2</code> for the first argument), use:</p>
<pre><code>echo -e &#39;\033[?6c&#39;</code></pre>
<p>To get red non-blinking block(<code>17</code> for the first argument, <code>0</code> for the second, <code>64</code> for the third), use:</p>
<pre><code>echo -e &#39;\033[?17;0;64c&#39;</code></pre>
</blockquote>
<h5>The First Argument</h5>
<p>In the first argument you specify cursor size:</p>
<pre><code>0=default
1=invisible
2=underline,
3=lower_third
4=lower_half
5=two_thirds
6=full block
7=full block
...
15=full block

+ 16 if you want the software cursor to be applied
+ 32 if you want to always change the background color
+ 64 if you dislike having the background the same as the
     foreground.</code></pre>
<p>The "<code>+16</code> for software cursor" is to mean, that in the range of <code>0</code>~<code>15</code>, you are using a hardware cursor. The value of the second and the third argument will always be <code>0</code> and you won't be able to change the default cursor color.</p>
<p>In the range of <code>48</code>~<code>63</code>(range <code>0</code>~<code>15</code> <code>+16</code> <code>+32</code>), you get a cursor that background color is always the same, which is, a NON-BLINKING cursor!</p>
<p>And in <code>112</code>~<code>127</code>, maybe it makes the foreground color not the same as the background one, letting the character be visible. I'm not sure about this. But anyway, it's also a NON-BLINKING cursor!</p>
<h5>The Second and the Third Argument</h5>
<p>I'm putting them together because they actually do the same thing. In the third argument you set the color sequence of 8 bits. And in the second argument you change the sequence using XOR.</p>
<p>On standard VGA, the high four bits and the low four bits specify the background and foreground color, respectively. The most significant bit in each four bits is for highlight (maybe blinking).</p>
<p>Assume that we have <code>0</code> for Argument 2, and <code>16</code> for Argument 3, so we have the two-bit sequence as follows:</p>
<pre><code>0000 0000 -- Argument 2
0001 0000 -- Argument 3</code></pre>
<p>XORing them, we get a bit sequence as <code>0001 0000</code>. The most significant bits of both the background group and the foreground group are set to zero. So this is, as well, a NON-BLINKING cursor! Meanwhile, the background color group is <code>001</code> and the foreground one is <code>000</code>. Each bit in the group stands for red, green, and blue (RGB), so through <code>001</code>, we get a cursor that having its background color blue.</p>
<h4>Apply to GRUB</h4>
<p>The kernel parameter that sets the default cursor shape has a format of <code>0xCCBBAA</code>. Because it's hexadecimal, the corresponding parameter to <code>echo -e &#39;\033[?17;0;32c&#39;</code> is <code>vt.cur_default=0x200011</code></p>
<p>We need to add them to the kernel argument field (<code>GRUB_CMDLINE_LINUX_DEFAULT</code>) in the default GRUB configuration file (at <code>/etc/default/grub</code>), and then regenerate it using <code>grub-mkconfig -o /boot/grub/grub.cfg</code>.</p>
<h4>Reference</h4>
<ul>
<li><a href="https://www.kernel.org/doc/html/v4.10/admin-guide/kernel-parameters.html" >The kernelâ€™s command-line parameters - The Linux Kernel</a></li><li><a href="https://linuxgazette.net/137/anonymous.html" >Cursor Appearance in the Linux Console - Linux Gazette</a></li>
</ul>
      </div>
    </div>
  </body>
</html>
